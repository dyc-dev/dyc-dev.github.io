<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>折腾鲲鹏920记</title>
    <link href="/2025/07/28/%E6%8A%98%E8%85%BE%E9%B2%B2%E9%B9%8F920%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0/"/>
    <url>/2025/07/28/%E6%8A%98%E8%85%BE%E9%B2%B2%E9%B9%8F920%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>当我最后跟着教程，win11 arm版系统如期在我的鲲鹏920服务器中跑起来的时候，其操作体验之丝滑，心中无限欣喜。连忙拍了张标志着arm win系统信息页发在了我的玩机小群，算了算，这已经是我拿到这台机子的第11天了。</p><p>这11天，有坚持，有相信，有猜测，有怀疑，有山穷水尽、柳暗花明，有沾沾自喜、乐极生悲。我像一个赌徒，在互联网二手电子产品交易场里，摆弄久违的心机，按捺本能的吝啬，绞尽可怜的知识，挥霍盲目的自信。一路走来，踩了许多坑，花费太多的心血和精力，几乎这些天下班后的晚上，只要在电脑前一坐，一晃已是深夜凌晨了。</p><p>那你以为我是个新手小白，又菜又爱玩？不，不是的。我接触华为鲲鹏系的服务器已经有一段时间了。毕竟这是在闲鱼(国内二手平台)上很容易获取到的企业升级淘汰的二手arm服务器设备。其特点就是量大，便宜，但有一定技术门槛。早在几个月前，我就因贪图64核心arm服务器的名头锁定了这些设备很久了。像平常玩的linux开发板，包括生活中常见的手机，其cpu芯片都是arm架构核心。不过这些设备仅在8-10核左右，性能和服务器几十上百核的规模是远远不能比的。心中麻麻痒，不知不觉在闲鱼上反复观望了许久。但毕竟价格上千，部分卖家报价又极自信，自己虽能承受，仍是舍不得买。农村人节约惯了，月薪不过三千，又成家了，心里总是想着能省则省的。</p><p>可人性偏爱贪小便宜，虽然说省，却总有安慰自己的借口。就像我假借着问问价格的名头，去试探性砍价。结果不怕你不出价，就怕你不问价，总有卖家被我砍下了许多。我大喜，自以为占了便宜，心想这些淘汰的设备毕竟专业性太强，市场流通还是难的。得了便宜还不足，还强令人家再送些东西。在我的坚持要求下，客服小妹为了能开张出单，勉强答应了下来我许多的要求。这样一番操作下来，看似得了便宜，却也不好意思不买了。于是我痛失一千四百五十大洋，购入了人生第一台服务器——华为泰山鲲鹏916型arm架构服务器。</p><span id="more"></span><p>然而，这台服务器的测试结果让我不是很满意。Geekbench6性能测试其单核仅有490分，多核为4900分左右。单核仅有rk3588芯片（国产主流arm soc芯片）的一半，多核仅比它高一些，可rk3588仅仅只有8个核心啊。这更比不上我的radxa o6（国产目前最强arm soc芯片）单核1200多核6000的成绩了。当我把916服务器的测试结果发在了aosc 系统和radxa开发板交流群里，群友调侃道：“你想有多强嘛，毕竟64个a72开会啊。”</p><p>啊，我恍然大悟。虽然核心多，也不过64个早期A72核心凑在一起，说起来他的核心架构和我的树莓派4b是一个级别的，又能跑多快呢。</p><p>经过查证，树莓派4b确实是4个A72核心，但在当时也算是很先进的。我仍记得我的树莓派4b是大学临毕业实习期间买的。我高中和大学虽说读的是文科，但从高中就喜欢开始研究电脑各种系统、沉迷于给手机刷机、开始研究c语言编程，对电子科技展现了浓厚的兴趣。大学买了10块一个月的阿里云服务器，开始用linux搭建minecraft云服务器。在知道树莓派之后，也从闲鱼二手市场给自己买了树莓派zero w、树莓派3b等开发板。小小的巴掌一样大小的开发板能跑完整的电脑系统甚至运行mc服务器，给当时的我带来了大大的震撼。那时候树莓派4b型是新发布的强劲机型，但毕竟舍不得买。直至实习的时候，在南昌接了几个家教赚了些钱。终于大气了一回，买了一套全新的树莓派4b奖给自己做礼物。那时候只觉得这开发板跑起来好快好快，一晃也是五六年前了，树莓派5b也发布许久了。现在我再把它开机运行，系统更新速度也很慢了，桌面一卡一卡的，已经被现在的设备远远甩在身后了。</p><p>话说回来，当真正得到鲲鹏916服务器后，感觉有些失望。毕竟我是个数据党，我虽然要便宜实惠的，但也要性能好的。为了这台服务器，我可是将那台rk3588芯片的香橙派5plus出售了，弥补了一些资金缺口。一来考虑香橙派5plus和我的radxa o6同样是arm开发板，o6的性能远远超过了香橙派5plus，留着它已经是没多大意义了。二来在我的游说下，桔子终于是同意了我这次购买。虽然我没提，也没说，后来才想到这香橙派5plus毕竟是桔子给我买的第一个比较喜欢的礼物。在摒弃许多，寄以厚望的情况下，这鲲鹏916服务器性能属实令人失望。</p><p>在失望过后，日子还是要过的。说实话，我并无出售它的想法。因为我有一种聊以自慰的相信，毕竟它可是有64个核心，我再也没有这么多核心cpu的设备了。另外，我认为它那么多核心，总有它擅长的地方，只是我的知识储备不够，无法真正发挥它多核心的作用，比如在编程、科学计算、高并发等场景不错。于是我又着手学习有关linux系统的知识，把我大学买的讲linux操作系统的书又翻出来正式去研究，又顺手在拼多多上买了许多关于arm架构关于linux系统的盗版书籍。白天工作，晚上又要看书，不免有些倦怠，进度自然是很慢的。不过我更多的是在这机器上做了许多实验，装了很多linux系统发行版。实践比看书有趣，也拓宽了许多不曾接触到的知识。</p><p>偶然一次，我以为自己发现服务器为什么跑分不够高的秘密而自喜。因为卖家最多只配了两个内存条，总共32g运行内存，而在机器的架构中有两个节点是没有装内存条的。通过deepseek对日志的分析，我才明白numa架构是给cpu内核以节点形式划分了固定运行内存。这台鲲鹏916服务器是2个32核cpu拼起来的64核服务器，共分成了4个numa节点，每个节点16个核心。其中2个numa节点没有运行内存，导致我32个cpu核心要跨区域访问内存，这确实会导致性能下降。我以为我抓住了重点，这将是让服务器找回性能关键。于是我上闲鱼又配了两个相同型号的32g内存，这确实平衡了服务器节点内存。但是测试结果仅仅让多核成绩多上了一两百分，这让我彻底无言，或许上限就在那里吧。</p><p>折腾便是学习，学习总有收获，收获带来成长。就在这折腾中，我反复观看了有关文档资料，知道如何获取驱动运维软件等相关资源，对服务器硬件以及软件系统有了初步的概念。比如如何通过ibmc系统管理，如何装pve系统同时运行多个操作系统之类的(因为性能的原因。win11arm版尝试安装失败了)。更重要的是，我渐渐的也对硬件性能开始回归平常，不再以唯性能论了。其64核心也确实在编译方面，网络并发服务方面有着强大的优势。虽然慢一些，能耗高一些，但只要能稳定运行不出错就是好的。它毕竟是一台企业级产品，虽然退役了，但是底子仍在。中途更是在群友的指导下，五百元购入一款鲲鹏920型网卡，它是24核32g运行内存的，可以很好的跑操作系统。这些都为我尝试收购后来的鲲鹏920型服务器奠定了充足的理论和实践基础。</p><p>说来也巧，就是因为这台920型网卡，我从闲鱼认识了这家服务器销售工作的老哥。他家大概是专门从事服务器整机和零配件销售的公司吧。他家的设备都是全新的配件，因为不知道怎么使用，所以本身卖的也比别家低一些。别家多是二手线材不齐全的设备挂个八九百价格，显然不如他家的实惠。欣闻我要用他的网卡拿来做研究，他便让我也教教他怎么玩。他是做硬件销售的，对自己所卖的东西知之甚少。我和他说可以在上面装系统，作为小型的服务器使用。他觉得很新奇。于是在我的请求下，他可以是说动用权限，给我便宜了十五块钱，我们也顺利加上了好友。</p><p>在获得920型网卡后，经过群友aca大佬的指导，购入了一些额外的设备方便供电。将相关信息发布后，又吸引了一些志同道合的人加入，我便组建了一个土垃圾淘货群。群名因为研究华为等国产淘汰下来的设备，对标所谓洋垃圾而言的。终于，网卡跑起来了，也给服务器老哥拉了几单生意。</p><p>有一次，老哥和我说起他家有一台双路96核的华为泰山鲲鹏920型服务器，不过是坏的，usb接口不能用，装不了系统。我便动了心思，一心撺掇他请示老板便宜些卖我。因为我知道后便研究过，该机型全新的两万五千多，二手目前也不低于一万。性能上也可圈可点，性能虽不算国际主流，也是国产中的第一梯队了，比我那台鲲鹏916型号单核起码多一倍的单核性能，更是多32个核心。如果低价收来，无疑是很捡漏的。再者，因为前期对该服务器的了解，就算usb不能用，本身走ibmc装系统是不用从usb口的。我试探开价1500，本着当废品收嘛。老哥人也挺好，也帮忙请示了老板，老板说4500才卖。那我便作罢了，一来我穷，二来谁会花那么多钱买一个不知道有没有用的机器呢。</p><p>事情很快又有了转机，服务器老哥一次和我闲聊，问我为啥收回去怎么使啊，又装不了系统。我没说仔细，便提了一嘴：“你把硬盘拆下来，在别的设备上装好系统再放进来不就可以跑了？”老哥恍然大悟，直夸我聪明。然后我再提了一下出售的事情，他就没理我了。过了几天临中午的时候，服务器老哥突然打qq电话给我问我怎么操作，系统装不上去，还让我远程看看。他说挂上系统，usb报错。</p><p>虽然感觉有些冒昧，但还是我帮他看了。远程登上ibmc一看，它这系统分明没装上。我让他重新装系统，他装好系统后确实进入系统了，系统网络获取不了ip，usb接口依然没用，鼠标键盘用不了。我还是想要，于是说三千出我，或者两千打头也行。他和我说老板意思是三千处理掉算了，虽然要处理，但也总要能用不是。测试到后面，我感觉还是能用的。此时已到饭点便去吃饭了，约好下午再试试。他说也不希望买回去是废品，我笑笑只当是客套话。</p><p>因为涉及用钱，我中午便和桔子说了这件事，桔子也同意了我做这笔买卖。下午再从qq问他，便一直不理人了。第二天问也是如此。桔子和我开玩笑说：“你就这样被人家套话了。他估计搞好了。”我哈哈一笑：“套吧套吧，无所谓的。”不过心里仍有一丝懊恼的，“人和人之间的信任了去哪了，看起来很真诚，没想到是套我的话。”</p><p>直到过了个把星期，老哥终于回了我的qq。他说没搞好，没时间搞。我便再次提出了购买的要求，他说可以，就是售出不可以退。如果要，他现在给老板打电话。他这么说，我便再砍一刀。我说那就两千五吧，买了不退，愿赌服输。他请示老板后，就这些敲定了。他很仔细地拍了机器细节给我。我提出再送些配件，他说都没有的。连硬盘架还是勉强送我的，因为不在库。我便作罢吧，老哥最后叮嘱我，这机子搞好了可以卖一万多，要爱护好，衷心希望我捡漏成功。此时我只沉浸在等待新玩具到来的欣喜中，完全想不到我会面对怎样的困难。</p><p>我也是做了些预案的，我也在闲鱼上为该服务器购置了内存，电源，nvme硬盘，pcie到u2硬盘转接板等必要相关硬件，并在radxa o6开发板上演练了如何用qemu虚拟机透传给硬盘装系统以应对服务器usb装不了系统的问题。同时反复观看相关文档指南，可谓做足了准备。</p><p>前途是光明的，道路是曲折的。设备到了，麻烦也来了。设想很美好，但一实践就到处踩坑。第一坑就是usb没法用，经验里的ibmc挂载iso镜像装系统竟然也是没法用的，大概也是走的同一套usb总线吧。经过了很多尝试，反复查看启动日志，连续几个晚上下了班在研究。usb始终是报错。好在我有第二个方案，通过装好系统盘开机。于是网购pcie转u2盘，又是等待的几天。</p><p>信心满满并没有变成满满自信。现实很残酷，nvme u2硬盘通过pcie转接板放在我的radxa o6上读写会卡死。哪怕拆了电脑atx电源单独供电也不成，该死的兼容性。于是折腾到半夜，我终于放弃这条路。果断把硬盘拆到楼上的鲲鹏916里，用里面的kvm装好了系统。此时已经是半夜，父母都睡了，桔子也多次催促休息了。就在我满心欢喜地把硬盘装进服务器启动，结果识别不了启动盘。我太难受了。反复插电拔电，检查接口接触问题。我最后怀疑是系统问题，这个系统不是鲲鹏官方支持，又去下了新的系统，准备安装。于是我把硬盘放到楼上的服务器中，结果楼上的服务器进了硬盘的系统，可没把我气笑了。也可见系统大概是没问题的。最终在桔子的催促下，我愤愤不平地睡去。</p><p>第二天，我和群友开玩笑说收了一台920机子，usb没法用，ibmc我不行。群友开玩笑说，不行他收了，走pcie转usb可解。我说不行，我还没玩热乎呢，你别想着收啊。既然此路不通，何不换一条路试试。但是pcie转usb的硬件我不熟，怕要驱动不兼容，而且该服务器的pcie转接板要三百大洋。同时问了下卖我机子的服务器老哥，我看他当时进了系统的呀。他和我说，他是在同型号的服务器上做的系统，还和我说，不行把硬盘寄给他，他帮我做个系统。</p><p>于是又在闲鱼上淘购。半夜有个服务器配件商老哥非常健谈，也很有商业头脑。他帮我分析出谋划策，给我配了一堆硬件。他很大方，说只要我出运费，设备测试不行都可以退。之前卖家试了网络也不行，也需要一张兼容的网卡。说实话，除了他家pcie转接板我是刚需外，其他的阵列卡、网卡等都不是必须，更何况他家货较别人的贵很多。我和他开玩笑说，这下买配件比服务器都要贵了。他之前问我多少买的我说2.5，他说贵了。他以为我说的是2.5万。直到我说是2500，他大呼卖给他吧。哈哈，最后谈妥，遂下单。</p><p>又是2天等待，sp333网卡、pcie转usb板、pcie转接卡等配件都到了，这次我是信心满满。因为资料上说，pcie转usb是不走系统的usb通道的，是独立的pcie的通道。也就是从理论上说，系统usb坏了，不影响pcie的usb使用。但结果很失望，装上这些硬件，bios设置没有一点变化，插键盘也不亮，情况一度陷入僵局。</p><p>终于在灵光一闪的尝试下，服务器终于取得了重大突破。我把键盘鼠标插进了pcie转usb。漫长的等待，突然鼠标亮了，有了此等变化后，我心里便有了底。这样u盘也肯定能进系统了。于是我把启动盘插进去，终于bios中出现了启动项。我很高兴，抱着桔子亲了好几口。几天的努力没有白费，终于取得了重大进展。凡事最怕没有进度条，有进度条就不怕等待，就像服务器漫长的开机自检，如果只看着logo画面或者静止的黑屏画面，那必然是怀疑人生的。但如果能看到系统自检日志滚动，哪怕再长的时间心里也是有底的。</p><p>我熟练地在U盘写入aosc、ubuntu等系统镜像，然后在服务器中找到了nvme硬盘，顺利的装好系统。结果又完了蛋，哪怕是在本机型上装的系统，服务器也不识别nvme盘上的启动项。我和卖配件的服务器老哥吐槽，他的硬件都没用，怕是要退货了。他听说了后，专门找了他们公司的技术帮我聊了这个问题。他们技术说，鲲鹏920这机型不支持在nvme硬盘上启动，nvme盘只能做存储设备。知道这层信息后，我不再尝试，退而求其次，通过usb口插入转接的sata固态硬盘，可以装系统，也有启动项可以进系统。至此，我买的服务器已经成功从废铁进化成了一个可玩的玩具。我跑了个分，发在了群里，到这一步蛮不容易的。</p><p>虽然能进系统，网络依然解决不了。还好我有一个大学时候买的linux免驱动的rt3070usb网卡，摸索了一阵网卡配置命令后，终于是连上网了。但是下了一堆sp333网卡驱动始终编译不成功，或是内核不对，安装后驱动不了。服务器配件老哥无奈，问我是退还是重新发一个新的给我，他刚好在发货。我说你发新的吧，不行两个都退。</p><p>Nvme硬盘无法安装系统，长期使用u盘里的系统毕竟不是个体统。还是得买阵列卡，走sas硬盘装系统。既然知道了重大进展就没事了。于是下定决心买内存，sas磁盘等硬件，一步到位。于是额外买了6根16G内存条，两个3tsas硬盘，一个1t硬盘。后面想想，颇有中场开香槟的感觉。</p><p>又过两天，所有硬件都到位了。然而崩溃的是，阵列卡时识别不了。这期间我又尝试了多种系统bios、主板、ibmc固件，皆是无用。终于好不容易出现了阵列卡驱动，也跟着教程成功在sas盘上做了raid0装好了系统，系统装完重启后终于能进了，一切多么美好。</p><p>然而就在我以为大局已定之时，问题还是存在。在晚上不玩服务器之后，我便将其下电关机。结果第二天玩的时候噩耗了，阵列卡的驱动又不识别了，ibmc报错。我为此反复折腾了几个夜晚，换驱动，换不同版本的服务器bios、主板固件，终于是认命了。我不再纠结于主板的报错，7t sas硬盘怕是用不上了。</p><p>有时候就要退而求其次。于是我把目光放在了nvme硬盘启动项问题的解决上。它既然安装系统的时候能识别，但没有引导项，这究竟是怎么回事。为什么服务器老哥他们家用nvme盘装好系统就能进。通过找资料，似乎提到了华为bios只支持特定nvme硬盘启动项。那有没有一种方法，我从U盘里启动一个启动项然后再启动nvme盘里的启动项从而进入系统呢。群友点拨了我一下：“有的，兄弟有的。用ventoy。”凭借着这一关键信息，我最终通过走u盘引导方案解决了问题。网络的问题则通过免驱的usb转2.5g网口模块解决了。对我来说，至此暂歇一口气，直呼完美。</p><p>当天晚上，我为服务器装上了pxvirt（pve arm版），这个系统可以做宿主机同时跑很多个系统。一口气将aosc和Ubuntu装上。第二天便很放松，跟着教程把心心念念的win11 arm版装好了。果然鲲鹏920就是啊。</p><p>机器终于跑起来了，我反倒是不怎么上心了。也没有过多的去测试软件，去玩系统，仅仅再跑了个分，发到我的群里。因为多加了6根内存条，共八根。我将它们均匀的分布在四个内存通道，多核跑分分数有所上涨。摆弄完，装完系统就没兴趣玩了。因为玩开发板的都这样，折腾机器的乐趣在于折腾，在于让软件、硬件跑起来的过程，而不在机器或者软件本身的使用。毕竟我要是想用这个软件，直接上x86平台就不好啦。虽然跑分显示系统timer有问题，对我来说，能用就已经很好了。够了，已经到极限了，不想再战斗了。我将多出来的网卡退了回去，将阵列卡和服务器本身的网卡挂上了咸鱼。做完这一切，我便彻底放松了。</p><p>在这个过程中，还是很感谢桔子的。服务器风扇的声音特别吵，一启动就像发动机一般，呼呼直叫。桔子晚上，有时中午都要顶着这么吵的声音休息，确实很不好意思。不过我一门心思扎在里面，近乎偏执，一方面是投入越来越大，购买配件的钱竟也差不多比服务器本身都要多了。我本身原本是很吝啬的，此时也逐渐成了一个赌徒，只想成功。另外是时间投入太多了，几乎每天晚上7点半一坐，时间一晃就到了12点，高度紧绷的神经和脑力思考使得整个人有些发狂。</p><p>哈哈哈，不过结果总算是好的。我终究是征服了这座大山，我学会了许多设备知识，掌握很多破解思路，感觉这也让我在垃圾佬的路上越走越远。我在考虑要不要搞个个人论坛或者博客什么的。后来服务器老哥问我是不是搞好了。我说搞是搞不好了，通过系列手段，勉强是能用了。老哥说能用就行，怕我买回去不能用。推荐我挂小黄鱼上卖了可以赚一笔。他还是很有责任心吧，甚至之前教我怎么将损失减少到最少。“全新的壳子不要搞划痕，可以卖500。网卡可以卖400。主板若是有人收去抵账可以卖个800到1000。”当然我更感激他能帮我做成这笔买卖。</p><p>后面没玩了，服务器开机主板又电压不正常报错，系统运行不了。看了下重启可以解决，分析认为是主板刚启动电压不稳定的时候不要着急启动虚拟机系统。<br>最近也可看了不少县里的征文故事，也动了写故事的心思。这两天便趁着记忆余温犹在，将这些故事整理出来，或发布，或放到以后的私人博客中，这毕竟是很有成就感的事情。<br>                                                                                                                      2025年7月28日</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
